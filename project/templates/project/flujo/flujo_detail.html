{% extends 'project/base_table.html' %}
{% load guardian_tags %}
{% block title %}{{ flujo }}{% endblock %}
{% block header %}{{ flujo.nombre | title }} {% endblock %}
{% block before_table %}
    <ul class="list-inline">
        {% get_obj_perms user for flujo.proyecto as "proyecto_perms" %}
        {% if "edit_flujo" in proyecto_perms %}
            <li><a href="{% url 'project:flujo_update'  flujo.id %}" class="fa fa-pencil"> Edit</a></li>{% endif %}
        {% if "remove_flujo" in proyecto_perms %}
            <li><a href="{% url 'project:flujo_delete'  flujo.id %}" class="fa fa-eraser"> Delete</a></li>{% endif %}
    </ul>
    <ul class="list-inline">
    {% if sprint %}
        <li><a href="{% url 'project:flujo_detail' flujo.id %}">Ver Todos</a></li>
    {% else %}
            {% for s in flujo.proyecto.sprint_set.all %}
                <li><a href="{% url 'project:flujo_detail_sprint' flujo.id s.id %}">{{ s }}</a></li>
            {% endfor %}
    {% endif %}
    </ul>
    <p><strong>Proyecto Asociado:</strong> {{ flujo.proyecto }}</p>
{% endblock %}
{% block thead %}
    {% for a in flujo.actividad_set.all %}
        <th class="text-center">{{ a }}</th>
    {% endfor %}
{% endblock %}
{% block tbody %}
    {% for a in flujo.actividad_set.all %}
        <td>
            <table class="table table-striped table-bordered table-hover">
                <thead>
                <th class="text-center">Todo</th>
                <th class="text-center">Doing</th>
                <th class="text-center">Done</th>
                </thead>
                {% for u in userstory %}
                    {% if  u.actividad == a %}
                        <tbody>
                        <tr>
                           <td>
                                     {% if u.estado_actividad == 0 %}
                                         {% if u.prioridad == 0 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-primary ">{{ u.nombre }}</a>
                                         {% elif u.prioridad == 1 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-warning ">{{ u.nombre }}</a>
                                         {% elif u.prioridad == 2 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-danger " >{{ u.nombre }}</a>
                                         {% endif %}
                                     {% endif %}
                                     </td>
                                     <td>
                                     {% if u.estado_actividad == 1 %}
                                         {% if u.prioridad == 0 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-primary ">{{ u.nombre }}</a>
                                         {% elif u.prioridad == 1 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-warning ">{{ u.nombre }}</a>
                                         {% elif u.prioridad == 2 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-danger " >{{ u.nombre }}</a>
                                         {% endif %}
                                     {% endif %}
                                     </td>
                                     <td>
                                         {% if u.estado_actividad == 2 %}
                                             {% if u.prioridad == 0 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-primary " >{{ u.nombre }}</a>
                                         {% elif u.prioridad == 1 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-warning ">{{ u.nombre }}</a>
                                         {% elif u.prioridad == 2 %}
                                             <a href="{% url 'project:userstory_detail' u.id %}" class="btn btn-outline btn-danger " >{{ u.nombre }}</a>
                                         {% endif %}
                                         {% endif %}

                                     </td>
                        </tr>
                        </tbody>
                    {% endif %}
                {% endfor %}
            </table>
        </td>
    {% endfor %}
{% endblock %}
{% block after_table %}
    <div class="col-lg-4">
        <div class="panel panel-primary">
            <div class="panel-heading">
                Observacion
            </div>
            <div class="panel-body">
                <p style="color: #d33333" >User story de prioridad alta</p>
                <p style="color: orange">User story de prioridad medio</p>
                <p style="color: #0044DD"> User story de prioridad baja</p>
            </div>
            <div class="panel-footer">
                Los colores representan la prioridad
            </div>
        </div>
    </div>
    <div class="col-lg-12">
            <p><a class="fa fa-step-backward" href="{% url 'project:flujo_list' flujo.proyecto.id %}"> Volver a
                Flujos</a></p>
    </div>
{% endblock %}